<html>
    <head>
        <title> Hello Jerry </title>
        <link rel="stylesheet" href="style.css"></link>
        <script>
            let FrameLen = 1;
            let Quality = 'normal';
            let Images = {normal: new Array(), high: new Array()};

            function PreloadImage(e) {
                [Quality, FrameLen] = e.target.value.split(" ");
                // Image Preload
                for (let i = 1; i <= FrameLen; i++) {
                    let img = new Image;
                    img.src = `./${Quality}/frame-${i}.png`;
                    Images[Quality][i-1] = img;
                }
            }

            window.onload = () => {
                const canvas = document.querySelector('canvas');
                const context = canvas.getContext('2d');
                const MaxScroll = (document.body.scrollHeight - document.body.clientHeight);
                
                function UpdateFrame() {
                    if (Images[Quality].length) {
                        if (window.scrollY == MaxScroll) window.scrollTo(0, 0);
                        let FrameNum = Math.min(FrameLen-1, Math.floor(window.scrollY / MaxScroll * FrameLen));
    
                        context.clearRect(0, 0, canvas.width, canvas.height);
                        context.drawImage(Images[Quality][FrameNum], 0, 0, Images[Quality][FrameNum].width, Images[Quality][FrameNum].height);
                    }
                    requestAnimationFrame(UpdateFrame);
                }

                requestAnimationFrame(UpdateFrame);

            }
        </script>
    </head>

    <body>
        <div class="Center">
            <h1>Jerry</h1>
            <canvas width="480" height="360"></canvas>
            
            <div>
                <input type="radio" id="normal" name="quality" value="normal 62" onclick="PreloadImage(event)">
                <label for="normal">Normal</label>

                <input type="radio" id="high" name="quality" value="high 481" onclick="PreloadImage(event)">
                <label for="high">High</label>
            </div>
        </div>
    </body>
</html>